<!-- ... header & body tetap ... -->
<main>
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
    <nav>
      <a href="#" data-tab="Berita" class="active">Berita</a>
      <a href="#" data-tab="Pengumuman">Pengumuman</a>
      <a href="#" data-tab="Peraturan">Peraturan</a>
    </nav>
    <input type="text" id="searchBox" placeholder="Cari..." style="padding:.5rem;border-radius:12px;border:1px solid #ccc;">
  </div>
  <div id="contentList"></div>
</main>

<!-- Popup -->
<div id="customPopup" class="popup hidden">
  <div class="popup-box">
    <p id="popupMessage"></p>
    <div class="popup-actions" id="popupActions"></div>
  </div>
</div>

<style>
.popup{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:flex;justify-content:center;align-items:center;z-index:4000;}
.popup.hidden{display:none;}
.popup-box{background:#fff;padding:1rem 1.5rem;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.2);max-width:320px;text-align:center;}
.popup-actions{margin-top:1rem;display:flex;gap:.5rem;justify-content:center;}
.popup-actions button{padding:.5rem 1rem;border:none;border-radius:8px;cursor:pointer;}
</style>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
import { getFirestore, collection, getDocs, query, where, orderBy } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";

const firebaseConfig={/* configmu */};
const app=initializeApp(firebaseConfig);
const db=getFirestore(app);

function showPopup(msg){const p=document.getElementById("customPopup");document.getElementById("popupMessage").textContent=msg;document.getElementById("popupActions").innerHTML='<button onclick="document.getElementById(`customPopup`).classList.add(`hidden`)">OK</button>';p.classList.remove("hidden");}

async function loadPosts(category){
  try{
    const q=query(collection(db,"posts"),where("category","==",category),where("status","==","Aktif"),orderBy("createdAt","desc"));
    const snap=await getDocs(q);
    const c=document.getElementById("contentList");c.innerHTML="";
    if(snap.empty){c.innerHTML="<p>Tidak ada data.</p>";return;}
    let data=[];
    snap.forEach(doc=>{data.push({id:doc.id,...doc.data()});});
    renderPosts(data);
  }catch(err){showPopup("Gagal memuat data: "+err.message);}
}

function renderPosts(data){
  const c=document.getElementById("contentList");
  const keyword=document.getElementById("searchBox").value.toLowerCase();
  c.innerHTML="";
  data.filter(d=>d.title.toLowerCase().includes(keyword)||d.content.toLowerCase().includes(keyword))
      .forEach(d=>{
        c.innerHTML+=`
          <div class="card">
            ${d.imageUrl?`<img src="${d.imageUrl}" class="thumb">`:""}
            <h3>${d.title}</h3>
            <div class="date">${d.createdAt?.toDate().toLocaleDateString("id-ID")||""}</div>
            <p>${d.content.substring(0,120)}...</p>
            <a href="detail.html?id=${d.id}" class="btn">Baca Selengkapnya</a>
          </div>`;
      });
}

document.querySelectorAll("nav a").forEach(a=>{
  a.addEventListener("click",e=>{
    e.preventDefault();
    document.querySelectorAll("nav a").forEach(x=>x.classList.remove("active"));
    a.classList.add("active");
    loadPosts(a.dataset.tab);
  });
});
document.getElementById("searchBox").addEventListener("input",()=>loadPosts(document.querySelector("nav a.active").dataset.tab));

loadPosts("Berita");
</script>
